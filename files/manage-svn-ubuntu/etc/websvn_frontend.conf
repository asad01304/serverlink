<VirtualHost *:80>
	ServerName @@FRONTEND_FQDN@@
	ServerAlias @@FRONTEND_FQDN@@

	DocumentRoot	/home/clients/websites/w_websvn/public_html

	RewriteEngine on
	RewriteCond	%{DOCUMENT_ROOT}%{REQUEST_FILENAME}     -f      [OR]
	RewriteCond	%{DOCUMENT_ROOT}%{REQUEST_FILENAME}     -d
	RewriteCond	%{REQUEST_FILENAME}                     !^/$
	RewriteRule	^(.+)                                   -       [L]

	RewriteMap	lowercase	int:tolower
	RewriteMap	svn-clients	txt:@@CLIENTS_MAP@@

	RewriteCond	%{HTTP_HOST}		^$
	RewriteRule	.*			/no_http_host_header.html			[R,L]

	RewriteCond	${lowercase:%{HTTP_HOST}|NONE}	^([^.]+).@@FRONTEND_FQDN@@$		[NC]
	RewriteRule	.*			-						[E=VHOST:%1,S=1]
	RewriteRule	.*			http://%{HTTP_HOST}/invalid_http_host.html	[R,L]

	RewriteCond	${svn-clients:%{ENV:VHOST}|NOT-FOUND}	^(.+)$
	RewriteCond	%1			!=NOT-FOUND
	RewriteRule	.*			-						[E=SVN_BACKEND:http://%1,S=1]
	RewriteRule	.*			http://%{HTTP_HOST}/unconfigured_host.html	[R,L]

	RewriteRule	^/(svnindex\..?s.?)$	%{ENV:SVN_BACKEND}/$1				[P,L]

	RewriteCond	%{REQUEST_URI}		!>/repos/
	RewriteRule	.*			-						[R=404,L]

	# We need to figure out how to do this redirection and not break the svn client
	#RewriteRule	^/repos/([^/!]+)$	http://%{HTTP_HOST}/repos/$1/			[R,L]

	RewriteRule	^/repos/(.*)$		%{ENV:SVN_BACKEND}/repos/$1			[P,L]
	RewriteRule	.*			-						[R=404,L]

	<Location />
		<Limit OPTIONS PROPFIND GET REPORT MKACTIVITY PROPPATCH PUT CHECKOUT MKCOL MOVE COPY DELETE LOCK UNLOCK MERGE>
			Order Deny,Allow
			Allow from all
			Satisfy Any
		</Limit>
	</Location>

	# Need separate logging for this virtual host?  Uncomment and configure it.
	#CustomLog logs/access_log combined
	#ErrorLog logs/error_log
</VirtualHost>

# Want an SSL'ed version of the frontend?  Configure the virtual host
# definition below, then comment out the following line and the
# corresponding closing tag.
<IfModule disabled>
<IfModule mod_ssl.c>
NameVirtualHost *:443
Listen 443

<VirtualHost *:443>
	ServerName @@FRONTEND_FQDN@@
	ServerAlias *.@@FRONTEND_FQDN@@
	RewriteEngine on
	RewriteMap	lowercase	int:tolower
	RewriteMap	svn-clients	txt:@@CLIENTS_MAP@@

	RewriteCond	%{HTTP_HOST}		^$
	RewriteRule	.*			/no_http_host_header.html			[R,L]

	RewriteCond	${lowercase:%{HTTP_HOST}|NONE}	^([^.]+).@@FRONTEND_FQDN@@$		[NC]
	RewriteRule	.*			-						[E=VHOST:%1,S=1]
	RewriteRule	.*			https://%{HTTP_HOST}/invalid_http_host.html	[R,L]

	RewriteCond	${svn-clients:%{ENV:VHOST}|NOT-FOUND}	^(.+)$
	RewriteCond	%1			!=NOT-FOUND
	RewriteRule	.*			-						[E=SVN_BACKEND:http://%1,S=1]
	RewriteRule	.*			https://%{HTTP_HOST}/unconfigured_host.html	[R,L]

	RewriteRule	^/(svnindex\..?s.?)$	%{ENV:SVN_BACKEND}/$1				[P,L]

	RewriteCond	%{REQUEST_URI}		!>/repos/
	RewriteRule	.*			-						[R=404,L]

	# We need to figure out how to do this redirection and not break the svn client
	#RewriteRule	^/repos/([^/!]+)$	http://%{HTTP_HOST}/repos/$1/			[R,L]

	RewriteRule	^/repos/(.*)$		%{ENV:SVN_BACKEND}/repos/$1			[P,L]
	RewriteRule	.*			-						[R=404,L]

	<Location />
		<Limit OPTIONS PROPFIND GET REPORT MKACTIVITY PROPPATCH PUT CHECKOUT MKCOL MOVE COPY DELETE LOCK UNLOCK MERGE>
			Order Deny,Allow
			Allow from all
			Satisfy Any
		</Limit>
	</Location>

	SSLEngine on
	SSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL
	SSLCertificateFile specify_path_to_your_certificate
	SSLCertificateKeyFile specify_path_to_your_private_key

	BrowserMatch ".*MSIE.*" \
		nokeepalive ssl-unclean-shutdown \
		downgrade-1.0 force-response-1.0

	# Need separate logging for this virtual host?  Uncomment and configure it.
	#CustomLog logs/access_log combined
	#ErrorLog logs/error_log
</VirtualHost>
</IfModule>
</IfModule>
